type: tool
name: replace
description: >-
  Replaces text within a file. By default, replaces a single occurrence, but can
  replace multiple occurrences when `expected_replacements` is specified. This
  tool requires providing significant context around the change to ensure
  precise targeting. Always use the read_file tool to examine the file's current
  content before attempting a text replacement.

  The user has the ability to modify the `new_string` content. If modified, this
  will be stated in the response.

  Expectation for required parameters:

  1. `old_string` MUST be the exact literal text to replace (including all
  whitespace, indentation, newlines, and surrounding code etc.).

  2. `new_string` MUST be the exact literal text to replace `old_string` with
  (also including all whitespace, indentation, newlines, and surrounding code
  etc.). Ensure the resulting code is correct and idiomatic and that `old_string`
  and `new_string` are different.

  3. `instruction` is the detailed instruction of what needs to be changed. Make
  it specific and detailed so developers or large language models can understand
  what needs to be changed and perform the changes on their own if necessary.

  4. NEVER escape `old_string` or `new_string`, that would break the exact
  literal text requirement.

  **Important:** If ANY of the above are not satisfied, the tool will fail.
  CRITICAL for `old_string`: Must uniquely identify the single instance to
  change. Include at least 3 lines of context BEFORE and AFTER the target text,
  matching whitespace and indentation precisely. If this string matches multiple
  locations, or does not match exactly, the tool will fail.

  5. Prefer to break down complex and long changes into multiple smaller atomic
  calls to this tool. Always check the content of the file after changes or not
  finding a string to match.

  **Multiple replacements:** Set `expected_replacements` to the number of
  occurrences you want to replace. The tool will replace ALL occurrences that
  match `old_string` exactly. Ensure the number of replacements matches your
  expectation.
input_schema:
  type: object
  properties:
    file_path:
      type: string
      description: The path to the file to modify.
    instruction:
      type: string
      description: >-
        A clear, semantic instruction for the code change, acting as a
        high-quality prompt for an expert LLM assistant. It must be
        self-contained and explain the goal of the change.

        A good instruction should concisely answer:
        1. WHY is the change needed?
        2. WHERE should the change happen?
        3. WHAT is the high-level change?
        4. WHAT is the desired outcome?

        **GOOD Example:** "In the 'calculateTotal' function, correct the sales
        tax calculation by updating the 'taxRate' constant from 0.05 to 0.075 to
        reflect the new regional tax laws."

        **BAD Examples:**
        - "Change the text." (Too vague)
        - "Fix the bug." (Doesn't explain the bug or the fix)
    old_string:
      type: string
      description: >-
        The exact literal text to replace, preferably unescaped. For single
        replacements (default), include at least 3 lines of context BEFORE and
        AFTER the target text, matching whitespace and indentation precisely.
        If this string is not the exact literal text (i.e. you escaped it) or
        does not match exactly, the tool will fail.
    new_string:
      type: string
      description: >-
        The exact literal text to replace `old_string` with, preferably
        unescaped. Provide the EXACT text. Ensure the resulting code is correct
        and idiomatic.
    expected_replacements:
      type: number
      minimum: 1
      description: >-
        Number of replacements expected. Defaults to 1 if not specified. Use
        when you want to replace multiple occurrences.
  required:
    - file_path
    - instruction
    - old_string
    - new_string
  additionalProperties: false
  $schema: http://json-schema.org/draft-07/schema#
