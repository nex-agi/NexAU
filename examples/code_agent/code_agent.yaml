type: agent
name: nexau_code_agent
max_context_tokens: 200000
system_prompt: ./systemprompt.md
system_prompt_type: jinja
tool_call_mode: anthropic # xml, openai or anthropic
max_iterations: 300

llm_config: # Support environment variable replacement in YAML config
  model: ${env.LLM_MODEL}
  base_url: ${env.LLM_BASE_URL}
  api_key: ${env.LLM_API_KEY}
  max_tokens: 32000
  temperature: 1
  stream: True
  api_type: anthropic_chat_completion
  thinking:
    type: adaptive
  output_config:
    effort: medium
  # support openai_chat_completion (default), openai_responses (especially for gpt-5-codex), anthropic_chat_completion
# Sandbox for file/shell tools.
# Set SANDBOX_WORK_DIR env before running, e.g. export SANDBOX_WORK_DIR=/tmp/code_agent_work
sandbox_config:
  type: local
  _work_dir: ${env.SANDBOX_WORK_DIR}
tools: # Builtin tools (nexau.archs.tool.builtin)
  # File operations
  - name: read_file
    yaml_path: ./tools/read_file.tool.yaml
    binding: nexau.archs.tool.builtin.file_tools:read_file
  - name: write_file
    yaml_path: ./tools/write_file.tool.yaml
    binding: nexau.archs.tool.builtin.file_tools:write_file
  - name: replace
    yaml_path: ./tools/replace.tool.yaml
    binding: nexau.archs.tool.builtin.file_tools:replace
  # Search and navigation
  - name: search_file_content
    yaml_path: ./tools/search_file_content.tool.yaml
    binding: nexau.archs.tool.builtin.file_tools:search_file_content
  - name: glob
    yaml_path: ./tools/Glob.tool.yaml
    binding: nexau.archs.tool.builtin.file_tools:glob
  - name: list_directory
    yaml_path: ./tools/list_directory.tool.yaml
    binding: nexau.archs.tool.builtin.file_tools:list_directory
  # Shell
  - name: run_shell_command
    yaml_path: ./tools/run_shell_command.tool.yaml
    binding: nexau.archs.tool.builtin.shell_tools:run_shell_command
  - name: BackgroundTaskManage
    yaml_path: ./tools/BackgroundTaskManage.tool.yaml
    binding: nexau.archs.tool.builtin:background_task_manage_tool
  # Web
  - name: web_search
    yaml_path: ./tools/WebSearch.tool.yaml
    binding: nexau.archs.tool.builtin.web_tools:google_web_search
  - name: web_read
    yaml_path: ./tools/WebFetch.tool.yaml
    binding: nexau.archs.tool.builtin.web_tools:web_fetch
  # Memory and task
  - name: save_memory
    yaml_path: ./tools/save_memory.tool.yaml
    binding: nexau.archs.tool.builtin.session_tools:save_memory
  - name: write_todos
    yaml_path: ./tools/write_todos.tool.yaml
    binding: nexau.archs.tool.builtin.session_tools:write_todos
  - name: complete_task
    yaml_path: ./tools/complete_task.tool.yaml
    binding: nexau.archs.tool.builtin.session_tools:complete_task
  - name: ask_user
    yaml_path: ./tools/ask_user.tool.yaml
    binding: nexau.archs.tool.builtin.session_tools:ask_user
skills: # Skills are used to hint the agent to solve specific tasks
  - ./skills/skill-creator
  - ./skills/template-skill
stop_tools: [complete_task]
middlewares: []
tracers:
  - import: nexau.archs.tracer.adapters.in_memory:InMemoryTracer
  - import: nexau.archs.tracer.adapters.langfuse:LangfuseTracer
    params:
      public_key: ${env.LANGFUSE_PUBLIC_KEY}
      secret_key: ${env.LANGFUSE_SECRET_KEY}
      host: https://langfuse.xiaobei.top/
